https://alexanderramirez.info/<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="styles.css" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBfGNR38S8ZFUE4hfIMTYp-BomBrUSIkN8&callback=initMap"
      async
      defer
    ></script>
    <script>
      function initMap() {
        var request = new XMLHttpRequest();
        var request2 = new XMLHttpRequest();
        var request3 = new XMLHttpRequest();
        var airQuality = new XMLHttpRequest();
        var markers = [];
        // Open a new connection, using the GET request on the URL endpoint
        //request.open("GET", "http://localhost:3000/", true);
        var checkBox = document.getElementById("myCheck");
        var checkBox2 = document.getElementById("myCheck2");
        var checkBox3 = document.getElementById("myCheck3");

        request.open(
          "GET",
          "https://data.cityofchicago.org/resource/v6vf-nfxy.json?$where=created_date%20between%20%27" +
            document.getElementById("startDate").value +
            "T12:00:00%27%20and%20%27" +
            document.getElementById("endDate").value +
            "T14:00:00%27&sr_short_code=" +
            document.getElementById("myText").value,
          true
        );
        request2.open(
          "GET",
          "https://data.cityofchicago.org/resource/85ca-t3if.json?$where=crash_date%20between%20%27" +
            document.getElementById("startDate").value +
            "T12:00:00%27%20and%20%27" +
            document.getElementById("endDate").value +
            "T14:00:00%27",
          true
        );
        request3.open(
          "GET",
          "https://data.cityofchicago.org/resource/ijzp-q8t2.json?$where=date%20between%20%27" +
            document.getElementById("startDate").value +
            "T12:00:00%27%20and%20%27" +
            document.getElementById("endDate").value +
            "T14:00:00",
          true
        );
        airQuality.open(
          "GET",
          "http://www.airnowapi.org/aq/observation/zipCode/historical/?format=application/json&zipCode=60601&date=2020-03-29T00-0000&distance=25&API_KEY=70D4330E-3376-4DC7-ABAC-C85E156BF36C",
          true
        );
        request.onload = function() {
          // Begin accessing JSON data here
          var data = JSON.parse(this.response);
          //console.log(data);
          for (var key in data) {
            //if (data.data[prop].sr_short_code == "AVN")
            console.log(data[key].latitude);
            markers.push({
              coords: {
                lat: parseFloat(data[key].latitude),
                lng: parseFloat(data[key].longitude)
              },
              content: data[key].sr_type + " <br/> " + data[key].created_date,
              iconImage: "phone.png"
            });
          }
        };

        request2.onload = function() {
          // Begin accessing JSON data here
          var data = JSON.parse(this.response);
          //console.log(data);
          for (var key in data) {
            console.log(data[key].crash_date);
            markers.push({
              coords: {
                lat: parseFloat(data[key].latitude),
                lng: parseFloat(data[key].longitude)
              },
              content:
                data[key].first_crash_type + " <br/> " + data[key].crash_date,
              iconImage: "car.png"
            });
          }
        };

        request3.onload = function() {
          // Begin accessing JSON data here
          var data = JSON.parse(this.response);
          //console.log(data);
          for (var key in data) {
            console.log(data[key].date);
            markers.push({
              coords: {
                lat: parseFloat(data[key].latitude),
                lng: parseFloat(data[key].longitude)
              },
              content: data[key].description + " <br/> " + data[key].date,
              iconImage: "car.png"
            });
          }
        };

        airQuality.onload = function() {
          // Begin accessing JSON data here
          var data = JSON.parse(this.response);
          console.log(data);
          
        };

        // Send requests
        if (checkBox.checked == true) {
          request.send();
        }
        if (checkBox2.checked == true) {
          request2.send();
        }
        if (checkBox2.checked == true) {
          request3.send();
        }

        airQuality.send();

        //map options
        var options = {
          zoom: 11,
          center: {
            lat: 41.8781,
            lng: -87.6298
          }
        };

        var map = new google.maps.Map(document.getElementById("map"), options);

        /*google.maps.event.addListener(map, "click", function(event) {
          addMarker({
            coords: event.latLng
          });
        });
        var markers = [
          {
            coords: { lat: 41.754829, lng: -87.550663 },
            iconImage: "phone.png",
            content: "<h1>House where phone pngphone.pngt grew up in</h1>"
          }
        ];*/

        setTimeout(function() {
          console.log("marker info start");
          console.log(markers.length);
          console.log(markers);
          console.log("marker info end");
          for (var i = 0; i < markers.length; i++) {
            addMarker(markers[i]);
          }
        }, 1000);

        //add Marker function
        function addMarker(props) {
          var marker = new google.maps.Marker({
            position: props.coords,
            map: map
          });
          //check for custom icon
          if (props.iconImage) {
            //set custom image
            marker.setIcon(props.iconImage);
          }

          if (props.content) {
            var infoWindow = new google.maps.InfoWindow({
              content: props.content
            });

            marker.addListener("click", function() {
              infoWindow.open(map, marker);
            });
          }
        }
      }
    </script>
    <title>Open311 API - City of Chicago</title>
  </head>
  <body>
    <div class="container">
      <h1>City of Chicago Smart City Center</h1>
      <p>
        Chicago's 311 system gives residents a central phone number and location
        to request city services, report non-emergency issues, and get updates
        on city work. Open311 provides greater access and transparency since it
        allows developers to build apps and websites on top of Chicago's 311
        system. Open311 is a REST-based Application Programmer Inferface (API)
        that lets developers requests directly to 311 and also retrieve status
        on existing service requests.
      </p>
      <table style="width:100%">
        <tr>
          <td>
            Start date <input type="text" id="startDate" value="2020-02-01" /> |
            End date <input type="text" id="endDate" value="2020-02-08" />
            <button onclick="initMap()">Search</button>
          </td>
          <td></td>
        </tr>
        <tr>
          <td>
            <img src="phone.png" /><input
              type="checkbox"
              id="myCheck"
              onclick="initMap()"
            />
            Service Code for 311 Requests:
            <input type="text" id="myText" value="SEL" />
            <button onclick="initMap()">Search</button>
          </td>
          <td>
            <img src="car.png" /><input
              type="checkbox"
              id="myCheck2"
              onclick="initMap()"
            />
            Car Crashes
          </td>
        </tr>
      </table>
    </div>
	
	<body>
	<form>
	  Select city request service:
	  <select id="mySelect">
		<option value="311IOC">311 INFORMATION ONLY CALL</option>
		<option value="SKA">Abandoned Vehicle Complaint</option>
		<option value="AVN">Aircraft Noise Complaint</option>
		<option value="SFA">Alley Light Out Complaint</option>
		<option value="PHB">Alley Pothole Complaint</option>
		<option value="AAI">Alley Sewer Inspection Request</option>
		<option value="EBD">Animal In Trap Complaint</option>
		<option value="SGG">Bee/Wasp Removal</option>
		<option value="PCL">Bicycle Request/Complaint</option>
		<option value="BBA">Building Violation</option>
		<option value="BUNGALOW">Bungalow Rehab/Purchase Information Request</option>
		<option value="CSC">Cab Feedback</option>
		<option value="OCC">Cable TV Complaint</option>
		<option value="QAC">City Vehicle Sticker Violation</option>
		<option value="NAA">Clean and Green Program Request</option>
		<option value="SCT">Clean Vacant Lot Request</option>
		<option value="CSF">Consumer Fraud Complaint</option>
		<option value="CST">Consumer Retail Store Complaint</option>
		<option value="CIAC">Coyote Interaction Complaint</option>
		<option value="SGQ">Dead Animal Pick-Up Request</option>
		<option value="SGV">Dead Bird</option>
		<option value="PCL3">E-Scooter</option>
		<option value="JNS">Extreme Weather Notification</option>
		<option value="FAC">Fire Safety Inspection Request</option>
		<option value="SDR">Fly Dumping Complaint</option>
		<option value="SIE">Garbage Cart Maintenance</option>
		<option value="GRAF">Graffiti Removal Request</option>
		<option value="HOP">Home Buyer Program Info Request</option>
		<option value="SDO">Ice and Snow Removal Request</option>
		<option value="FPC">Inaccurate Fuel Pump Complaint</option>
		<option value="INR">Inaccurate Retail Scales Complaint</option>
		<option value="HDF">Lead Inspection Request</option>
		<option value="LPRC">Licensed Pharmaceutical Representative Complaint</option>
		<option value="LIQUORCO">Liquor Establishment Complaint</option>
		<option value="WBK">Low Water Pressure Complaint</option>
		<option value="MWC">Minimum Wage Complaint</option>
		<option value="SCC">Missed Garbage Pick-Up Complaint</option>
		<option value="BBD">No Building Permit and Construction Violation</option>
		<option value="NOSOLCPP">No Solicitation Complaint</option>
		<option value="WBJ">No Water Complaint</option>
		<option value="EAB">Nuisance Animal Complaint</option>
		<option value="WBT">Open Fire Hydrant Complaint</option>
		<option value="RBL">Operating Without Business License Complaint</option>
		<option value="ODM">Outdated Merchandise Complaint</option>
		<option value="PSL">Paid Sick Leave Violation</option>
		<option value="PBE">Pavement Cave-In Inspection Request</option>
		<option value="PET">Pet Wellness Check Request</option>
		<option value="PETCO">Petcoke Dust Complaint</option>
		<option value="BPI">Porch Inspection Request</option>
		<option value="PHF">Pothole in Street Complaint</option>
		<option value="PBLDR">Protected Bike Lane - Debris Removal</option>
		<option value="CSP">Public Vehicle/Valet Complaint</option>
		<option value="CORNVEND">Pushcart Food Vendor Complaint</option>
		<option value="SCX">Recycling Inspection Request</option>
		<option value="RFC">Renters and Foreclosure Complaint</option>
		<option value="EAQ">Report an Injured Animal</option>
		<option value="HFB">Restaurant Complaint</option>
		<option value="TNP">Ridesharing Complaint</option>
		<option value="SGA">Rodent Baiting/Rat Complaint</option>
		<option value="SCB">Sanitation Code Violation</option>
		<option value="AAD">Sewer Cave-In Inspection Request</option>
		<option value="CHECKFOR">Sewer Cleaning Inspection Request</option>
		<option value="SHVR">Shared Housing/Vacation Rental Complaint</option>
		<option value="CAFE">Sidewalk Cafe Complaint</option>
		<option value="PBS">Sidewalk Inspection Request</option>
		<option value="PCE">Sign Repair Request - All Other Signs</option>
		<option value="PCD">Sign Repair Request - Do Not Enter Sign</option>
		<option value="PCC">Sign Repair Request - One Way Sign</option>
		<option value="PCB">Sign Repair Request - Stop Sign</option>
		<option value="HFF">Smokeless Tobacco at Sports Event Complaint</option>
		<option value="SDW">Snow - Object/Dibs Removal Request</option>
		<option value="SWSNOREM">Snow - Uncleared Sidewalk Complaint</option>
		<option value="SNPBLBS">Snow Removal - Protected Bike Lane or Bridge Sidewalk</option>
		<option value="EAE">Stray Animal Complaint</option>
		<option value="SDP">Street Cleaning Request</option>
		<option value="SFN">Street Light On During Day Complaint</option>
		<option value="SFD">Street Light Out Complaint</option>
		<option value="SFK">Street Light Pole Damage Complaint</option>
		<option value="SFQ">Street Light Pole Door Missing Complaint</option>
		<option value="BAG">Tobacco - General Complaint</option>
		<option value="BAM">Tobacco - Sale to Minors Complaint</option>
		<option value="SFB">Traffic Signal Out Complaint</option>
		<option value="SEL">Tree Debris Clean-Up Request</option>
		<option value="SED">Tree Planting Request</option>
		<option value="SEE">Tree Removal Request</option>
		<option value="SEF">Tree Trim Request</option>
		<option value="BBK">Vacant/Abandoned Building Complaint</option>
		<option value="VBL">Vehicle Parked in Bike Lane Complaint</option>
		<option value="SFC">Viaduct Light Out Complaint</option>
		<option value="EAF">Vicious Animal Complaint</option>
		<option value="AAF">Water in Basement Complaint</option>
		<option value="AAE">Water On Street Complaint</option>
		<option value="WCA">Water Quality Concern</option>
		<option value="SCP">Weed Removal Request</option>
		<option value="SCS">Wire Basket Request</option>
		<option value="SCQ">Yard Waste Pick-Up Request</option>
	  </select>
	</form>

	<button type="button" onclick="myFunction()">Select</button>

	<p id="demo"></p>

	<script>
	function myFunction() {
	  var x = document.getElementById("mySelect").value;
	  document.getElementById("demo").innerHTML = x;
	}
	</script>
	</body>
	
	
    <div id="map"></div>
    <br />
    
  </body>
</html>
